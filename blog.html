<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>博客 - 陈玉鹏</title>
  <meta name="description" content="陈玉鹏的个人博客" />
  <script src="/marked.min.js"></script>
  <style>
    :root {
      --bg: #0b0c0f;
      --text: #e7e9ee;
      --muted: #9aa2ad;
      --accent: #8ab4ff;
      --accent-hover: #6fa0ff;
      --card-bg: #14161b;
      --border: #2a2d35;
    }
    @media (prefers-color-scheme: light) {
      :root {
        --bg: #f6f7fb;
        --text: #111827;
        --muted: #6b7280;
        --accent: #1e40af;
        --accent-hover: #1e3a8a;
        --card-bg: #ffffff;
        --border: #e5e7eb;
      }
    }
    * {
      box-sizing: border-box;
    }
    html, body {
      margin: 0;
      padding: 0;
      min-height: 100%;
    }
    body {
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Noto Sans CJK SC", "Noto Sans SC", Arial, "Helvetica Neue", Helvetica, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border);
    }
    .header h1 {
      margin: 0;
      font-size: 24px;
      font-weight: 600;
    }
    .nav a {
      color: var(--muted);
      text-decoration: none;
      margin-left: 20px;
      font-size: 14px;
      transition: color 0.2s;
    }
    .nav a:hover {
      color: var(--accent);
    }
    .post-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .post-item {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 24px;
      margin-bottom: 16px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .post-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .post-item a {
      text-decoration: none;
      color: inherit;
    }
    .post-title {
      margin: 0 0 8px;
      font-size: 20px;
      font-weight: 600;
      color: var(--text);
    }
    .post-title:hover {
      color: var(--accent);
    }
    .post-meta {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 12px;
    }
    .post-description {
      margin: 0;
      font-size: 15px;
      color: var(--muted);
      line-height: 1.6;
    }
    .loading {
      text-align: center;
      color: var(--muted);
      padding: 40px;
    }
    .error {
      text-align: center;
      color: #ef4444;
      padding: 40px;
    }
    .empty {
      text-align: center;
      color: var(--muted);
      padding: 40px;
    }
    .footer {
      text-align: center;
      padding: 40px 20px;
      color: var(--muted);
      font-size: 14px;
      border-top: 1px solid var(--border);
      margin-top: 40px;
    }
    .footer a {
      color: var(--accent);
      text-decoration: none;
    }
    .footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>博客</h1>
      <nav class="nav">
        <a href="/">首页</a>
        <a href="/blog.html">文章</a>
      </nav>
    </div>
    <div id="postList">
      <div class="loading">加载中...</div>
    </div>
    <div class="footer">
      备案号：<a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener">苏ICP备16005330号-1</a>
    </div>
  </div>
  <script>
    const POSTS_DIR = '/posts/';
    const POST_FILES = [
      'welcome.md',
      'distributed-systems.md',
      'backend-best-practices.md'
    ];

    function parseFrontmatter(content) {
      const frontmatterRegex = /^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/;
      const match = content.match(frontmatterRegex);
      
      if (match) {
        const frontmatter = {};
        const lines = match[1].split('\n');
        lines.forEach(line => {
          const colonIndex = line.indexOf(':');
          if (colonIndex > 0) {
            const key = line.slice(0, colonIndex).trim();
            const value = line.slice(colonIndex + 1).trim();
            frontmatter[key] = value;
          }
        });
        return {
          ...frontmatter,
          content: match[2]
        };
      }
      
      return {
        title: '无标题',
        date: '',
        description: '',
        content: content
      };
    }

    async function loadPost(filename) {
      try {
        const response = await fetch(POSTS_DIR + filename);
        if (!response.ok) {
          throw new Error(`Failed to load ${filename}`);
        }
        const content = await response.text();
        const post = parseFrontmatter(content);
        return {
          ...post,
          filename: filename
        };
      } catch (error) {
        console.error(`Error loading ${filename}:`, error);
        return null;
      }
    }

    async function loadAllPosts() {
      const posts = [];
      
      for (const filename of POST_FILES) {
        const post = await loadPost(filename);
        if (post) {
          posts.push(post);
        }
      }
      
      return posts;
    }

    function formatDate(dateStr) {
      if (!dateStr) return '';
      const date = new Date(dateStr);
      return date.toLocaleDateString('zh-CN', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit'
      });
    }

    function renderPostList(posts) {
      const container = document.getElementById('postList');
      
      if (posts.length === 0) {
        container.innerHTML = '<div class="empty">暂无文章</div>';
        return;
      }
      
      const sortedPosts = posts.sort((a, b) => {
        const dateA = new Date(a.date || '1970-01-01');
        const dateB = new Date(b.date || '1970-01-01');
        return dateB - dateA;
      });
      
      const html = `
        <ul class="post-list">
          ${sortedPosts.map(post => `
            <li class="post-item">
              <a href="/post.html#${post.filename}">
                <h2 class="post-title">${post.title || '无标题'}</h2>
                <div class="post-meta">
                  ${formatDate(post.date)}
                  ${post.description ? ' · ' + post.description : ''}
                </div>
                <p class="post-description">${post.description || '暂无描述'}</p>
              </a>
            </li>
          `).join('')}
        </ul>
      `;
      
      container.innerHTML = html;
    }

    async function init() {
      const container = document.getElementById('postList');
      
      try {
        const posts = await loadAllPosts();
        renderPostList(posts);
      } catch (error) {
        container.innerHTML = `<div class="error">加载失败：${error.message}</div>`;
      }
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
